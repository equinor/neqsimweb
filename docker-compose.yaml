version: '3.4'
services:
  # #Need to remove the "SecurityFilter.java" check to make the application be available on the root of the url.
  # proxy:
  #   image: neqsim-proxy
  #   build: ./proxy
  #   ports:
  #     - "80:80"

  neqsimweb:
    container_name: neqsimweb
    hostname: neqsimweb
    image: neqsimweb
    build: .
    ports:
      - "80:8080"

  database:
    image: mysql:5.7
    command: --default-authentication-plugin=mysql_native_password --max_allowed_packet=325058560
    container_name: database
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: mintest
      MYSQL_DATABASE: neqsimdatabase
      MYSQL_USER: remote
      # TODO: Use secret and set db connectionstring from ENV
      MYSQL_PASSWORD: remote
    volumes:
      - "./data/database:/var/lib/mysql"
      # Only needed to populate DB 
      - "./data/dumps:/temporary"
    # # If you want to connect to the database directly, expose these ports.
    # ports:
    #   - "3306:3306"